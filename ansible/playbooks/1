---
- name: NETCONF
  hosts: all
  gather_facts: no

  tasks:
    - name: "Enable NETCONF"
      connection: network_cli
      junos_netconf:
      when: ansible_network_os == 'junos1'

    - name: "Get Config via NETCONF"  
      connection: netconf
      netconf_get:
         source: running
         filter: "<configuration><system></system></configuration>"
      register: nc_output

    - name: "configure via netconf"
      connection: netconf
      netconf_config:
          content: '<network-instances xmlns="http://openconfig.net/yang/network-instance">
  <network-instance>
    <name>default</name>
    <config>
      <name>default</name>
    </config>
    <vlans>
      <vlan>
        <vlan-id>100</vlan-id>
        <config>
          <vlan-id>100</vlan-id>
          <name>vlan100</name>
          <status>ACTIVE</status>
        </config>
      </vlan>
    </vlans>
  </network-instance>
</network-instances>'

    - debug:
        msg: '{{ nc_output }}'
        
